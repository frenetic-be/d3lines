var d3lines=function(){function Aa(a){return void 0!==a&&null!==a}function Ba(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Ca(a){var b={};return a&&"[object Function]"===b.toString.call(a)}function Da(a){return"string"==typeof a||a instanceof String}function Ea(a){try{var b=new Date(a);if(isNaN(b.getTime()))return;return b}catch(a){return}}function Fa(a){return"[object Array]"==Object.prototype.toString.call(a)}function Ga(a,b,c,d){if(arguments.length<4&&(d=!0),!Aa(a))return c;if(!a.hasOwnProperty(b))return c;var e=a[b];return d&&delete a[b],e}function Ha(a){return Ba(a)?"float":Fa(a)?"array":typeof a}function Ia(a){var b={};if(!Aa(a))return a;var c=Object.keys(a);return 0===c.length||Da(a)||a instanceof Ja?a:Fa(a)?(b=[],a.forEach(function(a,c){b.push(Ia(a))}),b):(c.forEach(function(c){b[c]=Ia(a[c])}),b)}function Ja(a){if(!Aa(a))return void(this.data=a);if(!(this instanceof Ja))return new Ja(a);var b=Ha(a);if("array"===b){if(0!=a.length){var c=Ha(a[0]),d=a.reduce(function(a,b){return a&&Ha(b)===c});if(!d)throw TypeError("Data has mixed types");if("object"===c)this.data=a;else if("array"===c){var e=[];a.forEach(function(a,b){e.push({}),a.forEach(function(a,c){e[b]["y"+(c+1)]=a})}),this.data=e}else{if("float"!==c)throw TypeError("Data type is not supported");var e=[];a.forEach(function(a){e.push({y:a})}),this.data=e}}}else{if("object"!==b)throw TypeError("Data type is not supported");var g,e=[],f=Object.keys(a);f.forEach(function(b,c){if(!Fa(a[b]))throw TypeError("Data type is not supported");if(0===c)g=a[b].length;else if(a[b].length!==g)throw TypeError("Inconsistent number of elements for different keys");a[b].forEach(function(a,d){0===c&&e.push({}),e[d][b]=a})}),this.data=e}}function Ka(a){this.group=a}function La(a,b,c,d){if(!(this instanceof La))return new La(a,b,c,d);Ka.call(this,a),this.lines=b,this.areas=c,this.markers=d}function Ma(a,b,c,d){if(!(this instanceof Ma))return new Ma(a,b,c,d);Ka.call(this,a),this.x=b,this.y=c,this.y2=d}function Na(a,b,c,d,e){if(!(this instanceof Na))return new Na(a,b,c,d,e);Ka.call(this,a),this.x=b,this.y=c,this.y2=d,this.labels=void 0===e?new Ma:e}function Oa(a){if(!(this instanceof Oa))return new Oa(a);Ka.call(this,a)}function Pa(a,b){if(!(this instanceof Pa))return new Pa(a,b);Ka.call(this,a),this.rect=b}function Qa(a,b,c,d,e,f){if(!(this instanceof Qa))return new Qa(a,b,c,d,e,f);Ka.call(this,a),this.hline=b,this.vline=c,this.dots=d,this.box=e,this.text=f}function Ra(a){if(!(this instanceof Ra))return new Ra(a);this.main=a,this.axes=new Na,this.box=new Pa,this.lines=new La,this.legend=new Oa,this.interactive=new Qa}function Sa(a){if(arguments.length<1)throw TypeError("d3lines.Chart takes 1 argument: a d3.Selection of an svg tag.");if(!(this instanceof Sa))return new Sa(a);this.options={},this.width=void 0,this.height=void 0,this.margins={},this.xaxis=void 0,this.yaxis=void 0,this.y2axis=void 0,this.line_options=[],this.scale={},this.svg=new Ra(a)}function Ta(a,b,c,d){return d3.svg.line().x(function(b,c){return a(d.hasOwnProperty("x")?d.x[c]:c)}).y(function(a,e){return d.hasOwnProperty("y")?b(d.offset_y[e]):d.hasOwnProperty("y2")?c(d.offset_y2[e]):b(e)})}function Ua(a,b,c,d,e){return Aa(c)||(paddingLeft=parseFloat(window.getComputedStyle(a.node()).paddingLeft),paddingRight=parseFloat(window.getComputedStyle(a.node()).paddingRight),c=d3.scale.linear().range([-paddingLeft,a.node().clientWidth-paddingRight]).domain([0,1])),Aa(d)||(paddingTop=parseFloat(window.getComputedStyle(a.node()).paddingTop),paddingBottom=parseFloat(window.getComputedStyle(a.node()).paddingBottom),d=d3.scale.linear().range([a.node().clientHeight-paddingBottom,-paddingTop]).domain([0,1])),oa=Ga(e,"line_color","#777",!1),pa=Ga(e,"line_width",1,!1),qa=Ga(e,"line_style","-",!1),a.append("line").attr("x1",c(b)).attr("y1",d.range()[0]).attr("x2",c(b)).attr("y2",d.range()[1]).style("stroke",oa).style("stroke-width",pa).style("stroke-dasharray",Ya(qa))}function Va(a,b,c,d,e){return Aa(c)||(paddingLeft=parseFloat(window.getComputedStyle(a.node()).paddingLeft),paddingRight=parseFloat(window.getComputedStyle(a.node()).paddingRight),c=d3.scale.linear().range([-paddingLeft,a.node().clientWidth-paddingRight]).domain([0,1])),Aa(d)||(paddingTop=parseFloat(window.getComputedStyle(a.node()).paddingTop),paddingBottom=parseFloat(window.getComputedStyle(a.node()).paddingBottom),d=d3.scale.linear().range([a.node().clientHeight-paddingBottom,-paddingTop]).domain([0,1])),oa=Ga(e,"line_color","#777",!1),pa=Ga(e,"line_width",1,!1),qa=Ga(e,"line_style","-",!1),a.append("line").attr("x1",c.range()[0]).attr("y1",d(b)).attr("x2",c.range()[1]).attr("y2",d(b)).style("stroke",oa).style("stroke-width",pa).style("stroke-dasharray",Ya(qa))}function Wa(a){return a.each(function(){var a=d3.select(this),b={},c=d3.select(a.property("nearestViewportElement")),d=parseFloat(a.attr("data-style-padding")||5);lb=a.selectAll(".legend-box").data([!0]),lb.enter().append("rect").classed("legend-box",!0),c.selectAll("[data-legend]").each(function(){for(var a=d3.select(this),c=a.attr("data-legend");b.hasOwnProperty(c);){var d=c.split("-"),e=c,f=2;d.length>1&&Ba(d[d.length-1])&&(f=parseFloat(d[d.length-1])+1,e=d.slice(0,d.length-1).join("-")),c=e+"-"+f}b[c]={pos:a.attr("data-legend-pos")||this.getBBox().y,line_color:"none"!==a.attr("data-line-color")?a.attr("data-line-color"):a.attr("data-line-fill"),line_width:a.attr("data-line-width"),line_style:a.attr("data-line-style"),marker:a.attr("data-marker"),marker_fill:a.attr("data-marker-fill"),marker_fill_opacity:a.attr("data-marker-fill-opacity"),marker_size:a.attr("data-marker-size"),marker_stroke_width:a.attr("data-marker-stroke-width"),symbol:""!==Za(a.attr("data-marker"),6)?Za(a.attr("data-marker"),6)():null}}),b=d3.entries(b).sort(function(a,b){return a.value.pos-b.value.pos});var e=a.append("g").attr("class","legend-items"),f=parseFloat(window.getComputedStyle(e[0][0]).getPropertyValue("font-size")),g=e.selectAll("g").data(b),h=g.enter().append("g").attr("transform",function(a,b){return"translate(0, "+1.2*b*f+")"});h.append("line").attr("x2","1.5em").attr("y1","-0.38em").attr("y2","-0.38em").style("fill","none").style("stroke",function(a){return a.value.line_color}).style("stroke-width",function(a){return a.value.line_width}).style("stroke-dasharray",function(a){return Ya(a.value.line_style)}),h.append("path").attr("d",function(a){return a.value.symbol}).attr("transform",function(a,b){return"translate("+.75*f+", "+-.38*f+")"}).style("stroke",function(a){return a.value.line_color}).style("fill",function(a){return"color"===a.value.marker_fill?a.value.line_color:a.value.marker_fill}).style("fill-opacity",function(a){return a.value.marker_fill_opacity}).style("stroke-width",function(a){return a.value.marker_stroke_width}),h.append("text").attr("x","2em").text(function(a){return a.key});var i=e[0][0].getBBox();e.attr("transform","translate("+(-i.x+d)+","+(-i.y+d)+")"),lb.attr("x",0).attr("y",0).attr("height",i.height+2*d).attr("width",i.width+2*d)}),a}function Xa(b,c,d,e,f,g){if(Ba(e)){if(e<=0)throw"ValueError: `layoutType` should be a strictly positive number.";var h,i,j,k;if(Aa(b))switch(d){case"x":c.forEach(function(a){a.hasOwnProperty("x")?(h=d3.min([h,d3.min(a.x)]),i=d3.max([i,d3.max(a.x)])):(h=0,i=b.length)});break;case"y":c.forEach(function(a){a.hasOwnProperty("y")&&(h=d3.min([h,d3.min(a.offset_y)]),i=d3.max([i,d3.max(a.offset_y)]))});break;case"y2":c.forEach(function(a){a.hasOwnProperty("y2")&&(h=d3.min([h,d3.min(a.offset_y2)]),i=d3.max([i,d3.max(a.offset_y2)]))})}else h=0,i=1;if(Aa(h)||(h=0),Aa(i)||(i=1),g&&(h=d3.min([h,f.domain()[0]]),i=d3.max([i,f.domain()[1]])),f.type!==a.LOG||h instanceof Date||i instanceof Date)if(f.type===a.LOG&&h instanceof Date&&i instanceof Date){if(h<0||i<0)throw"ValueError: Cannot use a logarithmic scale with negative data";var l=Math.log10(i.getTime())-Math.log10(h.getTime()),m=Math.log10(h)+l/2,n=l*e;j=new Date(Math.pow(10,m-n/2)),k=new Date(Math.pow(10,m+n/2))}else if(h instanceof Date&&i instanceof Date){var l=i.getTime()-h.getTime(),m=h.getTime()+l/2,n=l*e;j=new Date(m-n/2),k=new Date(m+n/2)}else{var l=i-h,m=h+l/2,n=l*e;j=m-n/2,k=m+n/2}else{if(h<0||i<0)throw"ValueError: Cannot use a logarithmic scale with negative data";var l=Math.log10(i)-Math.log10(h),m=Math.log10(h)+l/2,n=l*e;j=Math.pow(10,m-n/2),k=Math.pow(10,m+n/2)}}else{if(!Fa(e)||2!=e.length)throw TypeError("`layoutType` should be a strictly-positive float or a two-element float array");if(j=e[0],k=e[1],!Ba(j)||!Ba(k))throw TypeError("`layoutType` should be a two-element float array")}f.domain([j,k])}function Ya(a){switch(a){case":":case"dotted":return"1 1";case"-":case"solid":return"";case"--":case"dashed":return"3 3";case"-.":case"dash-dot":return"5 2 1 2";default:return a}}function Za(a,b){var c=u*u;switch(Ba(b)?c=b*b:Ca(b)&&(c=function(a,c){return b(a,c)*b(a,c)}),a){case"o":case"circle":return d3.svg.symbol().type("circle").size(c);case"+":case"cross":return d3.svg.symbol().type("cross").size(c);case"d":case"diamond":return d3.svg.symbol().type("diamond").size(c);case"s":case"square":return d3.svg.symbol().type("square").size(c);case"^":case"triangle-up":return d3.svg.symbol().type("triangle-up").size(c);case"v":case"triangle-down":return d3.svg.symbol().type("triangle-down").size(c);default:return""}}function $a(a,b){return Fa(a)?a[b%a.length]:a}function _a(a,b){var c={};if(Aa(a)&&Object.keys(a).forEach(function(b,d){c[b]=a[b]}),c.hasOwnProperty("color")||(c.color=$a(oa,b)),c.hasOwnProperty("width")||(c.width=$a(pa,b)),c.hasOwnProperty("style")||(c.style=$a(qa,b)),c.hasOwnProperty("fill")||(c.fill=$a(ra,b)),c.hasOwnProperty("fill_opacity")||(c.fill_opacity=$a(sa,b)),c.hasOwnProperty("marker")||(c.marker=$a(ta,b)),c.hasOwnProperty("marker_fill")||(c.marker_fill=$a(ua,b)),c.hasOwnProperty("marker_fill_opacity")||(c.marker_fill_opacity=$a(va,b)),c.hasOwnProperty("marker_stroke_width")||(c.marker_stroke_width=$a(wa,b)),c.hasOwnProperty("marker_size")||(c.marker_size=$a(xa,b)),!c.hasOwnProperty("ykey")&&!c.hasOwnProperty("y2key"))throw"Line does not have an `ykey` or `y2key` property. The `ykey` or `y2key` property should be the names of a field of all data element objects.";return c}function ab(a,b,c){var e=null,f=null,g=null,h=null;b.forEach(function(b,d){b.hasOwnProperty(c)&&b[c].forEach(function(b,c){Aa(b)&&!isNaN(b)&&(null===e||Math.abs(b-a)<f)&&(e=b,g=c,h=d,f=Math.abs(a-e))})});var i={};return b.forEach(function(a){a.hasOwnProperty(c)&&a[c].forEach(function(b,c){(b===e||b instanceof Date&&e instanceof Date&&b.getTime()===e.getTime())&&(a.hasOwnProperty("xkey")&&!isNaN(a.x[c])&&(i[a.xkey]=a.x[c]),a.hasOwnProperty("ykey")&&!isNaN(a.y[c])&&(i[a.ykey]=a.y[c]),a.hasOwnProperty("y2key")&&!isNaN(a.y2[c])&&(i[a.y2key]=a.y2[c]))})}),[i,h,g]}function bb(a,b,c,d,e,f){function g(a,b,c,e,f){return Math.sqrt(Math.pow(a-d(c),2)+Math.pow(b-f(e),2))}var i,j,s,k="",l="",m=null,n=null,o=null,p=null,q=null,r=null,t="";c.forEach(function(c,d){c.x.forEach(function(h,u){c.hasOwnProperty("y")?(i=c.offset_y[u],j=c.y[u],s=e,t="y"):(i=c.offset_y2[u],j=c.y2[u],s=f,t="y2"),Aa(h)&&!isNaN(h)&&Aa(i)&&!isNaN(i)&&(null===m||g(a,b,h,i,s)<r)&&(m=h,n=j,p=u,q=d,k=c.xkey,l=c.hasOwnProperty("y")?c.ykey:c.y2key,r=g(a,b,h,i,s),o=t)})});var u={};return u[k]=m,u[l]=n,[u,q,p,o]}function cb(a,b){var c=Ga(b,"box",B,!1),d=Ga(b,"axes_font_size",fa,!1),e=Ga(b,"axes_font_color",ia,!1),f=Ga(b,"axes_font_family",ha,!1),g=Ga(b,"axes_color",ia,!1),h=Ga(b,"axes_width",ja,!1),i=Ga(b,"axes_linestyle",ma,!1);c?a.selectAll(".d3lines-axis path").each(function(){d3.select(this).style("fill","none").style("stroke","none")}):a.selectAll(".d3lines-axis path").each(function(){d3.select(this).style("fill","none").style("stroke",g).style("stroke-width",h).style("stroke-dasharray",Ya(i))}),a.selectAll(".d3lines-axis line").each(function(){var a=d3.select(this);a.classed("d3lines-grid")||a.style("stroke",g).style("stroke-width",h).style("stroke-dasharray",Ya(i))}),a.selectAll(".d3lines-axis text").each(function(){var a=d3.select(this);a.style("font-size",d),void 0!==e&&a.style("fill",e),void 0!==f&&a.style("font-family",f)})}function db(a,b,c){Aa(b)||(b={});var g=Ga(b,"width",d,!1),h=Ga(b,"height",e,!1),i=Ia(f);if(Aa(b.margins)&&Object.keys(b.margins).forEach(function(a){i[a]=b.margins[a]}),Ga(b,"xgrid",C,!1)){var k=Ga(b,"xgrid_color",D,!1),l=Ga(b,"xgrid_width",E,!1),m=Ga(b,"xgrid_linestyle",F,!1);a.selectAll(".d3lines-xaxis .tick").each(function(a,b){var c=d3.select(this);0===c.selectAll("line.d3lines-grid").size()&&c.append("line").attr("class","d3lines-grid d3lines-xgrid").attr("y2",-h+i.bottom+i.top).style("stroke",k).style("stroke-width",l).style("stroke-dasharray",Ya(m))})}if(Ga(b,"ygrid",G,!1)){var o=Ga(b,"ygrid_color",H,!1),p=Ga(b,"ygrid_width",I,!1),q=Ga(b,"ygrid_linestyle",J,!1);a.selectAll(".d3lines-yaxis .tick").each(function(a,b){var c=d3.select(this);0===c.selectAll("line.d3lines-grid").size()&&c.append("line").attr("class","d3lines-grid d3lines-ygrid").attr("x2",g-i.left-i.right).style("stroke",o).style("stroke-width",p).style("stroke-dasharray",Ya(q))})}var r=Ga(b,"y2grid",K,!1);if(c&&r){var s=Ga(b,"y2grid_color",L,!1),t=Ga(b,"y2grid_width",M,!1),u=Ga(b,"y2grid_linestyle",N,!1);a.selectAll(".d3lines-y2axis .tick").each(function(a,b){var c=d3.select(this);0===c.selectAll("line.d3lines-grid").size()&&c.append("line").attr("class","d3lines-grid d3lines-y2grid").attr("x2",-g+i.left+i.right).style("stroke",s).style("stroke-width",t).style("stroke-dasharray",Ya(u))})}}var v,w,x,y,z,A,Q,R,ha,a={LINEAR:"LINEAR",LOG:"LOG",TIME:"TIME"},b=!0,c="line",d=800,e=500,f={top:15,right:70,bottom:50,left:70},g="left",h=["blue","red","limegreen","magenta","cyan","black","orange"],i=1.5,j=0,k="-",l="none",m=1,n="",o=["o","s","v","d","^","+"],p="white",q=["#ddf","#fdd","#ded","#fdf","#dff","#ddd","#fed"],r=1,s=1,t=1,u=8,B=!0,C=!1,D="#BBB",E=.5,F=":",G=!1,H="#BBB",I=.5,J=":",K=!1,L="#BBB",M=.5,N=":",O=!0,P="0.875em",S="white",T=1,U="#777",V=1,W="-",X="top left",Y=1,Z=1.05,$=1.05,_="",aa="",ba="",ca=0,da=0,ea=0,fa="1em",ia="#777",ja=1,ka="none",la=1,ma="-",na=!0;DEFAULT_INTERACTIVE_OPTIONS={snap_axis:"x",line:!0,line_style:"-",line_width:1,line_color:"#777",dots:!0,dot_radius:5,textbox:!0,box_fill:"#ffb4b4",box_padding:10,box_fill_opacity:.95,font_size:"1em",font_color:"black",font_family:"",output_string:function(a){var b=[];return Object.keys(a).forEach(function(c,d){b.push(c+": "+a[c])}),b.join("<br>")},zoom:!0};var oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za;return Ja.prototype.toString=function(){return"[object d3lines.Data]"},Ja.prototype.transpose=function(a,b){Aa(a)||(a=""),Aa(b)||(b=a),""===b&&(b="x");var c=this.data;if(Aa(c)){if(!Fa(c))throw TypeError("The data should be an array of dictionaries.");if(0!==c.length){var e,d=[];return c.forEach(function(f,g){e=f[a],Object.keys(c[0]).filter(function(b){return b.trim()!==a}).forEach(function(a,c){0===g&&(d.push({}),d[c][b]=a),d[c][e]=f[a]})}),new Ja(d)}}},Ja.prototype.sanitize=function(){var a=this.data;if(Aa(a)){if(!Fa(a))throw TypeError("The data should be an array of dictionaries.");if(a=a.filter(function(a){return Object.keys(a).length>0}),0!==a.length){var b=Object.keys(a[0]).filter(function(a){return""!==a.trim()}),c=[];b.forEach(function(b){"object"==typeof a[0][b]?c.push("object"):Ba(a[0][b])||"string"==typeof a[0][b]&&""===a[0][b].trim()?c.push("float"):Aa(Ea(a[0][b]))?c.push("date"):c.push("string")});var e,f,d=[];return a.forEach(function(a){e={},f=!0,b.forEach(function(b,d){switch(c[d]){case"object":null==a[b]?e[b]=NaN:(e[b]=a[b],f=!1);break;case"string":case"float":Ba(a[b])?"string"==typeof a[b]&&""===a[b].trim()?e[b]=NaN:(e[b]=parseFloat(a[b]),f=!1):e[b]=NaN;break;case"date":var h=Ea(a[b]);Aa(h)?(e[b]=h,f=!1):e[b]=NaN}}),f||d.push(e)}),new Ja(d)}}},Ja.prototype.removeNaNColumns=function(){var a=this.data;if(Aa(a)){if(!Fa(a))throw TypeError("The data should be an array of dictionaries.");if(0!==a.length){var b=Object.keys(a[0]);for(dataIndex in a)if(row=a[dataIndex],b.forEach(function(a,c){"number"==typeof row[a]&&isNaN(row[a])||delete b[b.indexOf(a)]}),b.every(function(a){return!Aa(a)}))break;if(b=b.filter(Aa),0===b.length)return new Ja(a);var c=[];for(dataIndex in a)row=a[dataIndex],b.forEach(function(a,b){delete row[a]}),c.push(row);return new Ja(c)}}},Ja.prototype.sample=function(a,b){var c=this.data;if(1==arguments.length?(b=a,a=0):0==arguments.length&&(a=0,b=5),Aa(c)){if(!Fa(c))throw TypeError("The data should be an array of dictionaries.");if(0!==c.length){var d=[],f=[];return c.forEach(function(e,g){0==g&&(f=Object.keys(c[0]).filter(function(a){return""!==a.trim()}));var h={};f.slice(a,b).forEach(function(a,b){h[a]=e[a]}),d.push(h)}),new Ja(d)}}},Ja.prototype.selectColumns=function(a){var b=this.data;if(Aa(b)){if(!Fa(b))throw TypeError("The data should be an array of dictionaries.");if(0!==b.length&&Aa(a)&&Fa(a)){var c=[],e=[];return b.forEach(function(d,f){0==f&&(e=Object.keys(b[0]).filter(function(b){return-1!=a.indexOf(b)}));var g={};e.forEach(function(a,b){g[a]=d[a]}),c.push(g)}),new Ja(c)}}},Ja.prototype.ignoreColumns=function(a){var b=this.data;if(Aa(b)){if(!Fa(b))throw TypeError("The data should be an array of dictionaries.");if(0!==b.length&&Aa(a)&&Fa(a)){var c=[],e=[];return b.forEach(function(d,f){0==f&&(e=Object.keys(b[0]).filter(function(b){return-1==a.indexOf(b)}));var g={};e.forEach(function(a,b){g[a]=d[a]}),c.push(g)}),new Ja(c)}}},Ja.prototype.filterColumns=function(a){var b=this.data;if(Aa(b)){if(!Fa(b))throw TypeError("The data should be an array of dictionaries.");if(0!==b.length){var c=[],e=[];return b.forEach(function(d,f){0==f&&(e=Object.keys(b[0]).filter(a));var g={};e.forEach(function(a,b){g[a]=d[a]}),c.push(g)}),new Ja(c)}}},Ka.prototype.remove=function(){var a=this;void 0!==a&&void 0!==a.group&&(a.group.remove(),a.group=void 0)},Ka.prototype.append=function(a){var b=this;void 0!==b.group&&b.group.append(a)},La.prototype=Object.create(Ka.prototype),La.prototype.constructor=La,La.prototype.remove=function(){Ka.prototype.remove.call(this),this.lines=void 0,this.areas=void 0,this.markers=void 0},Ma.prototype=Object.create(Ka.prototype),Ma.prototype.constructor=Ma,Ma.prototype.remove=function(){Ka.prototype.remove.call(this),this.x=void 0,this.y=void 0,this.y2=void 0},Na.prototype=Object.create(Ka.prototype),Na.prototype.constructor=Na,Na.prototype.remove=function(){Ma.prototype.remove.call(this.labels),Ka.prototype.remove.call(this),this.x=void 0,this.y=void 0,this.y2=void 0,this.labels=void 0},Oa.prototype=Object.create(Ka.prototype),Oa.prototype.constructor=Oa,Pa.prototype=Object.create(Ka.prototype),Pa.prototype.constructor=Pa,Pa.prototype.remove=function(){Ka.prototype.remove.call(this),this.rect=void 0},Qa.prototype=Object.create(Ka.prototype),Qa.prototype.constructor=Qa,Qa.prototype.remove=function(){Ka.prototype.remove.call(this),this.hline=void 0,this.vline=void 0,this.dots=void 0,this.box=void 0,this.text=void 0},Ra.prototype.removeAll=function(){this.axes.remove(),this.box.remove(),this.lines.remove(),this.legend.remove(),this.interactive.remove();for(var a=this.main.node();a.hasChildNodes();)a.removeChild(a.lastChild)},Sa.prototype.copy=function(a){if(!a instanceof Sa)throw TypeError("You can only copy a d3lines.Chart object");this.options=Ia(a.options),this.width=a.width,this.height=a.height,this.margins=Ia(a.margins),this.xaxis=a.xaxis,this.yaxis=a.yaxis,this.y2axis=a.y2axis,this.line_options=Ia(a.line_options);var b=this.scale;Object.keys(a.scale).forEach(function(c){b[c]=a.scale[c]}),this.svg=a.svg},Sa.prototype.redrawXAxis=function(a){var b=this;Aa(b.svg.axes.x)&&Aa(b.xaxis)&&b.svg.axes.x.call(b.xaxis),Aa(a)||(a=!0),a&&(cb(b.svg.main,b.options),db(b.svg.main,b.options,b.scale.hasOwnProperty("y2")))},Sa.prototype.redrawYAxis=function(a){var b=this;Aa(b.svg.axes.y)&&Aa(b.yaxis)&&b.svg.axes.y.call(b.yaxis),Aa(a)||(a=!0),a&&(cb(b.svg.main,b.options),db(b.svg.main,b.options,b.scale.hasOwnProperty("y2")))},Sa.prototype.redrawY2Axis=function(a){var b=this;Aa(b.svg.axes.y2)&&Aa(b.y2axis)&&b.svg.axes.y2.call(b.y2axis),Aa(a)||(a=!0),a&&(cb(b.svg.main,b.options),db(b.svg.main,b.options,b.scale.hasOwnProperty("y2")))},Sa.prototype.redrawLine=function(a){function g(a,b){return(!d.hasOwnProperty("x")||!isNaN(d.x[b]))&&((!d.hasOwnProperty("y")||!isNaN(d.offset_y[b]))&&(!d.hasOwnProperty("y2")||!isNaN(d.offset_y2[b])))}var b=this;if(Aa(b.svg.lines.lines)){var c=b.svg.lines.lines[a],d=b.line_options[a],e=b.svg.lines.areas[a],f=b.svg.lines.markers[a];if(d.hasOwnProperty("x")&&(d.hasOwnProperty("y")||d.hasOwnProperty("y2"))){data=Array(d.x.length);var h=Ta(b.scale.x,b.scale.y,b.scale.y2,d);if(h.defined(g),c.attr("d",h(data)),Aa(e)){var i=d3.svg.area().x(h.x()).y(h.y()).y0(b.scale.y.range()[0]).defined(g);e.attr("d",i)}Aa(f)&&f.selectAll("path").attr("transform",function(a,b){return"translate("+h.x()(a,b)+","+h.y()(a,b)+")"})}}},Sa.prototype.redrawLines=function(){var a=this;if(Aa(a.svg.lines.lines)&&Aa(a.svg.lines.areas)&&Aa(a.svg.lines.markers)&&!(Fa(a.svg.lines.lines)&&Fa(a.svg.lines.areas)&&Fa(a.svg.lines.markers)&&a.line_options.length!==a.svg.lines.lines.length&&a.svg.lines.areas.length!==a.svg.lines.lines.length&&a.svg.lines.markers.length!==a.svg.lines.lines.length)){a.svg.lines.lines.forEach(function(b,c){a.redrawLine(c)})}},Sa.prototype.redraw=function(){var a=this;a.scale.hasOwnProperty("original_x")&&a.scale.hasOwnProperty("original_y")&&a.scale.hasOwnProperty("x")&&a.scale.hasOwnProperty("y")&&Aa(a.svg.lines.lines)&&Aa(a.svg.lines.areas)&&Aa(a.svg.lines.markers)&&(a.redrawXAxis(!1),a.redrawYAxis(!1),a.redrawY2Axis(!1),cb(a.svg.main,a.options),db(a.svg.main,a.options,a.scale.hasOwnProperty("y2")),a.redrawLines())},Sa.prototype.reset=function(){var a=this;a.scale.hasOwnProperty("original_x")&&a.scale.hasOwnProperty("x")&&a.scale.x.domain([a.scale.original_x.domain()[0],a.scale.original_x.domain()[1]]),a.scale.hasOwnProperty("original_y")&&a.scale.hasOwnProperty("y")&&a.scale.y.domain([a.scale.original_y.domain()[0],a.scale.original_y.domain()[1]]),a.scale.hasOwnProperty("original_y2")&&a.scale.hasOwnProperty("y2")&&a.scale.y2.domain([a.scale.original_y2.domain()[0],a.scale.original_y2.domain()[1]]),a.redraw()},{isArray:Fa,isNumeric:Ba,hline:Va,vline:Ua,Data:Ja,Chart:Sa,SVGChart:Ra,SVGGroup:Ka,SVGAxesGroup:Na,SVGAxesLabelGroup:Ma,SVGBoxGroup:Pa,SVGInteractiveGroup:Qa,SVGLegendGroup:Oa,SVGLinesGroup:La,plot:function(ga,Ba,Ca){function Bc(a){if(Aa(a)){Ac=a;var b=a.pageX-Ea.offsetLeft,c=a.pageY-Ea.offsetTop,d=(b-jb.left)/(kb-jb.left-jb.right),e=1-(c-jb.top)/(lb-jb.top-jb.bottom);if(Aa(uc)&&uc.style("display","none"),Aa(vc)&&vc.style("display","none"),Aa(yc)&&Aa(zc)&&(yc.style("display","none"),zc.style("display","none")),Aa(xc)&&xc.forEach(function(a){a.style("display","none")}),!(d<0||d>1||e<0||e>1)){if("x"==jc.snap_axis){var f=mb.invert(b),g=ab(f,Ra,jc.snap_axis),h=g[0],i=g[1],j=g[2];Aa(uc)&&uc.attr("x1",mb(Ra[i].x[j])).attr("x2",mb(Ra[i].x[j])).style("display","block")}else if("y"==jc.snap_axis){var k=nb.invert(c),g=ab(k,Ra,"offset_y"),h=g[0],i=g[1],j=g[2];Aa(vc)&&vc.attr("y1",nb(Ra[i].offset_y[j])).attr("y2",nb(Ra[i].offset_y[j])).style("display","block")}else if("both"==jc.snap_axis){var g=bb(b,c,Ra,mb,nb,ob),h=g[0],i=g[1],j=g[2],l=g[3];Aa(uc)&&uc.attr("x1",mb(Ra[i].x[j])).attr("x2",mb(Ra[i].x[j])).style("display","block"),Aa(vc)&&("y"===l?vc.attr("y1",nb(Ra[i].offset_y[j])).attr("y2",nb(Ra[i].offset_y[j])).style("display","block"):"y2"===l&&Aa(ob)&&vc.attr("y1",ob(Ra[i].offset_y2[j])).attr("y2",ob(Ra[i].offset_y2[j])).style("display","block"))}if(Aa(xc))for(index=Ra.length-1;index>=0;index--){var m=Ra[index];h.hasOwnProperty(m.xkey)&&isNaN(h[m.xkey])?xc[index].style("display","none"):m.hasOwnProperty("ykey")&&h.hasOwnProperty(m.ykey)&&isNaN(h[m.ykey])?xc[index].style("display","none"):m.hasOwnProperty("y2key")&&h.hasOwnProperty(m.y2key)&&isNaN(h[m.y2key])?xc[index].style("display","none"):h.hasOwnProperty(m.ykey)||h.hasOwnProperty(m.y2key)?"stack"===za&&m.hasOwnProperty("ykey")&&isNaN(m.offset_y[j])?xc[index].style("display","none"):"stack"===za&&m.hasOwnProperty("y2key")&&isNaN(m.offset_y2[j])?xc[index].style("display","none"):("stack"===za?(xc[index].attr("cx",mb(h[m.xkey])),m.hasOwnProperty("ykey")?xc[index].attr("cy",nb(m.offset_y[j])):xc[index].attr("cy",ob(m.offset_y2[j]))):(xc[index].attr("cx",mb(h[m.xkey])),m.hasOwnProperty("ykey")?xc[index].attr("cy",nb(h[m.ykey])):xc[index].attr("cy",ob(h[m.y2key]))),xc[index].style("display","block")):xc[index].style("display","none")}var n=jc.output_string(h);if(Aa(yc)&&Aa(zc)){zc.text("");var o=parseFloat(getComputedStyle(zc[0][0]).fontSize);n.split(new RegExp("<br ?/?>")).forEach(function(a,d){zc.append("tspan").text(a).attr("x",b+10+jc.box_padding).attr("y",c+10+jc.box_padding+o).attr("dy",1.2*d+"em")}),zc.style("display","block");var p=zc[0][0].getBBox(),q=p.height+2*jc.box_padding,r=p.width+2*jc.box_padding;if(lb-q<c+10){yc.attr("y",lb-q);var s=zc.selectAll("tspan");s.each(function(a,b){d3.select(s[0][b]).attr("y",lb-q+jc.box_padding+o)})}else yc.attr("y",c+10);if(kb-r<b+10){yc.attr("x",kb-r);var s=zc.selectAll("tspan");s.each(function(a,b){d3.select(s[0][b]).attr("x",kb-r+jc.box_padding)})}else yc.attr("x",b+10);yc.attr("width",r).attr("height",q).style("display","block")}}}}if(!(ga instanceof d3.selection))throw TypeError("`svg` must be a d3.selection object.");var Ea=ga.node(),Ha=!1;Aa(Ca)&&"object"==typeof Ca&&(Ha=!0);var Ka=new Sa(ga);Ha?Ka.copy(Ca):Ka.options=Ia(Ba);var La=0;if(Ha&&Fa(Ka.line_options)&&(La=Ka.line_options.length),Aa(Ba)&&"object"!=typeof Ba)throw TypeError("`options` should be an Object");var Ma=Ia(Ba)||{};za=Ga(Ma,"plot_type",c);var Na=Ga(Ma,"data");if(Aa(Na)){Na instanceof Ja||(Na=new Ja(Na));Ga(Ma,"data_sanitization",b)&&(Na=Na.sanitize()),Na=Na.data}var Pa=Ga(Ma,"xkey"),Qa=Ga(Ma,"ykey");"scatter"==za?(pa=Ga(Ma,"line_width",j),ta=Ga(Ma,"marker",o),ua=Ga(Ma,"marker_fill",q),va=Ga(Ma,"marker_fill_opacity",s)):(pa=Ga(Ma,"line_width",i),ta=Ga(Ma,"marker",n),ua=Ga(Ma,"marker_fill",p),va=Ga(Ma,"marker_fill_opacity",r)),ya=Ga(Ma,"line_yaxis",g),oa=Ga(Ma,"line_color",h),qa=Ga(Ma,"line_style",k),ra=Ga(Ma,"line_fill",l),sa=Ga(Ma,"line_fill_opacity",m),wa=Ga(Ma,"marker_stroke_width",t),xa=Ga(Ma,"marker_size",u);var Ra=[],eb=[],fb=[],gb=[],hb=[];if(Aa(Pa)&&(eb.push(Pa),hb.push(Pa)),Aa(Qa)&&(fb.push(Qa),hb.push(Qa)),Aa(Ma.lines)&&(Ma.lines.forEach(function(a){!a.hasOwnProperty("xkey")&&Aa(Pa)&&(a.xkey=Pa),a.hasOwnProperty("ykey")||a.hasOwnProperty("y2key")||!Aa(Qa)||(a.ykey=Qa);var b=_a(a,La);La+=1,b.hasOwnProperty("xkey")&&-1==hb.indexOf(b.xkey)&&(eb.push(b.xkey),hb.push(b.xkey)),b.hasOwnProperty("ykey")&&-1==hb.indexOf(b.ykey)?(fb.push(b.ykey),hb.push(b.ykey)):-1==hb.indexOf(b.y2key)&&(gb.push(b.y2key),hb.push(b.y2key)),Ra.push(b)}),delete Ma.lines),0==Ra.length&&Aa(Na)){if(!Fa(Na))throw TypeError("Wrong type for `data`");Object.keys(Na[0]).forEach(function(a){var b=$a(ya,La);Aa(Pa)?a!=Pa&&("right"===b?Ra.push(_a({xkey:Pa,y2key:a},La)):Ra.push(_a({xkey:Pa,ykey:a},La)),La+=1):("right"===b?Ra.push(_a({y2key:a},La)):Ra.push(_a({ykey:a},La)),La+=1)})}if(Ra.length>0&&!Aa(Na))throw TypeError("`data` is undefined.");if(Ra.length>0&&!Fa(Na))throw TypeError("Wrong type for `data`");if(Ra.length>0&&0==Na.length)throw new ValueError("`data` is empty");if(Ra.length>0&&Na.forEach(function(a,b){hb.forEach(function(c){if(!a.hasOwnProperty(c))throw"Missing key "+c+" in data element "+b})}),Ra.forEach(function(a,b){if(a.hasOwnProperty("xkey")&&!a.hasOwnProperty("x")?a.x=Array.apply(null,Array(Na.length)).map(function(b,c){return Na[c][a.xkey]}):(a.xkey="index",a.x=Array.apply(null,Array(Na.length)).map(function(a,b){return b})),a.hasOwnProperty("ykey")&&!a.hasOwnProperty("y")?(a.y=Array.apply(null,Array(Na.length)).map(function(b,c){return Na[c][a.ykey]}),"stack"===za&&b!=Ra.length-1||(a.offset_y=Array.apply(null,Array(Na.length)).map(function(b,c){return Na[c][a.ykey]}),a.offset_y2=Array.apply(null,Array(Na.length)).map(function(a,b){return 0}))):a.hasOwnProperty("y2key")&&!a.hasOwnProperty("y2")&&(a.y2=Array.apply(null,Array(Na.length)).map(function(b,c){return Na[c][a.y2key]}),"stack"===za&&b!=Ra.length-1||(a.offset_y2=Array.apply(null,Array(Na.length)).map(function(b,c){return Na[c][a.y2key]}),a.offset_y=Array.apply(null,Array(Na.length)).map(function(a,b){return 0}))),!a.hasOwnProperty("x"))throw"ValueError: LINES["+b+"] does not have the `x` key";if(!a.hasOwnProperty("xkey"))throw"ValueError: LINES["+b+"] does not have the `xkey` key";if(!a.hasOwnProperty("y")&&!a.hasOwnProperty("y2"))throw"ValueError: LINES["+b+"] does not have the `y` oy `y2` key";if(!a.hasOwnProperty("ykey")&&!a.hasOwnProperty("y2key"))throw"ValueError: LINES["+b+"] does not have the `ykey` oy `y2key` key"}),"stack"===za)for(line_index=Ra.length-2;line_index>=0;line_index--){var ib=Ra[line_index];ib.hasOwnProperty("y")?(ib.offset_y=Array.apply(null,Array(ib.y.length)).map(function(a,b){var c=Ra[line_index+1].offset_y[b];return ib.y[b]+c}),ib.offset_y2=Array.apply(null,Array(Na.length)).map(function(a,b){return 0})):ib.hasOwnProperty("y2")&&(ib.offset_y2=Array.apply(null,Array(ib.y2.length)).map(function(a,b){var c=Ra[line_index+1].offset_y2[b];return ib.y2[b]+c}),ib.offset_y=Array.apply(null,Array(Na.length)).map(function(a,b){return 0}))}var jb={};if(Ha){var kb=Ga(Ka,"WIDTH",d,!1),lb=Ga(Ka,"HEIGHT",e,!1);Object.keys(f).forEach(function(a,b){jb[a]=f[a]}),Aa(Ka.margins)&&Object.keys(Ka.margins).forEach(function(a,b){jb[a]=Ka.margins[a]}),Ma.hasOwnProperty("width")&&delete Ma.width,Ma.hasOwnProperty("height")&&delete Ma.height,Ma.hasOwnProperty("margins")&&delete Ma.margins}else{var kb=Ga(Ma,"width",d),lb=Ga(Ma,"height",e);Object.keys(f).forEach(function(a,b){jb[a]=f[a]}),Aa(Ma.margins)&&(Object.keys(Ma.margins).forEach(function(a,b){jb[a]=Ma.margins[a]}),delete Ma.margins),Ka.width=kb,Ka.height=lb,Ka.margins=jb}if(kb<jb.left+jb.right)throw"ValueError: `width` should be larger than the sum of the left and right margins.";if(Ha)Ka.scale.hasOwnProperty("x")||(Ka.scale.x=d3.scale.linear()),Ka.scale.hasOwnProperty("y")||(Ka.scale.y=d3.scale.linear()),mb=Ga(Ka.scale,"x",d3.scale.linear(),!1),nb=Ga(Ka.scale,"y",d3.scale.linear(),!1),ob=Ga(Ka.scale,"y2",void 0,!1),Aa(Ma.xscale_type)&&delete Ma.xscale_type,Aa(Ma.yscale_type)&&delete Ma.yscale_type,Aa(Ma.y2scale_type)&&delete Ma.y2scale_type;else{var mb,nb,ob;Aa(Ma.xscale_type)?("time"==Ma.xscale_type?(mb=d3.time.scale(),mb.type=a.TIME):"log"==Ma.xscale_type?(mb=d3.scale.log(),mb.type=a.LOG):(mb=d3.scale.linear(),mb.type=a.LINEAR),delete Ma.xscale_type):(mb=d3.scale.linear(),mb.type=a.LINEAR),Aa(Ma.yscale_type)?("time"==Ma.yscale_type?(nb=d3.time.scale(),nb.type=a.TIME):"log"==Ma.yscale_type?(nb=d3.scale.log(),nb.type=a.LOG):(nb=d3.scale.linear(),nb.type=a.LINEAR),delete Ma.yscale_type):(nb=d3.scale.linear(),nb.type=a.LINEAR),Aa(Ma.y2scale_type)&&("time"==Ma.y2scale_type?(ob=d3.time.scale(),ob.type=a.TIME):"log"==Ma.y2scale_type?(ob=d3.scale.log(),ob.type=a.LOG):(ob=d3.scale.linear(),ob.type=a.LINEAR),delete Ma.y2scale_type)}Ra.forEach(function(b){b.hasOwnProperty("y2key")&&!Aa(ob)&&(ob=d3.scale.linear(),ob.type=a.LINEAR)});var pb=Ga(Ma,"xticks",v),qb=Ga(Ma,"yticks",w),rb=Ga(Ma,"y2ticks",x),sb=Ga(Ma,"xtick_format",y),tb=Ga(Ma,"ytick_format",z),ub=Ga(Ma,"y2tick_format",A),vb=Ga(Ma,"box",B),Ib=(Ga(Ma,"xgrid",C),Ga(Ma,"xgrid_color",D),Ga(Ma,"xgrid_width",E),Ga(Ma,"xgrid_linestyle",F),Ga(Ma,"ygrid",G),Ga(Ma,"ygrid_color",H),Ga(Ma,"ygrid_width",I),Ga(Ma,"ygrid_linestyle",J),Ga(Ma,"y2grid",K),Ga(Ma,"y2grid_color",L),Ga(Ma,"y2grid_width",M),Ga(Ma,"y2grid_linestyle",N),Ga(Ma,"legend",O)),Jb=Ga(Ma,"legend_font_size",P),Kb=Ga(Ma,"legend_font_color",Q),Lb=Ga(Ma,"legend_font_family",R),Mb=Ga(Ma,"legend_fill",S),Nb=Ga(Ma,"legend_fill_opacity",T),Ob=Ga(Ma,"legend_border_color",U),Pb=Ga(Ma,"legend_border_width",V),Qb=Ga(Ma,"legend_border_style",W),Rb=Ga(Ma,"legend_position",X),Sb=Ga(Ma,"legend_labels"),Tb=Ga(Ma,"xlim",Y),Ub=Ga(Ma,"ylim",Z),Vb=Ga(Ma,"y2lim",$),Wb=Ga(Ma,"xlabel",_);""===Wb&&Aa(Pa)&&(Wb=Pa);var Xb=Ga(Ma,"ylabel",aa),Yb=Ga(Ma,"y2label",ba),Zb=Ga(Ma,"xlabel_offset",ca),$b=Ga(Ma,"ylabel_offset",da),_b=Ga(Ma,"y2label_offset",ea),ac=Ga(Ma,"axes_font_size",fa),bc=Ga(Ma,"axes_font_color",ia),cc=Ga(Ma,"axes_font_family",ha),dc=Ga(Ma,"axes_color",ia),ec=Ga(Ma,"axes_width",ja),fc=Ga(Ma,"axes_fill",ka),gc=Ga(Ma,"axes_fill_opacity",la),hc=Ga(Ma,"axes_linestyle",ma),ic=Ga(Ma,"interactive",na),jc={};if(Object.keys(DEFAULT_INTERACTIVE_OPTIONS).forEach(function(a,b){jc[a]="snap_axis"===a&&"scatter"===za?"both":DEFAULT_INTERACTIVE_OPTIONS[a]}),Aa(Ma.interactive_options)&&(Object.keys(Ma.interactive_options).forEach(function(a,b){jc[a]=Ma.interactive_options[a]}),delete Ma.interactive_options),-1===["x","y","both"].indexOf(jc.snap_axis)&&(jc.snap_axis="x"),Object.keys(Ma).forEach(function(a){throw"ValueError: unknown key `"+a+"`"}),Ha?(Xa(Na,Ra,"x",Tb,mb,Ha),Xa(Na,Ra,"y",Ub,nb,Ha),Ka.scale.original_x=mb.copy(),Ka.scale.original_y=nb.copy(),Aa(ob)&&(ob.range([lb-jb.bottom,jb.top]),Xa(Na,Ra,"y2",Vb,ob,Ha),Ka.scale.y2=ob,Ka.scale.original_y2=ob.copy())):(Ea.setAttribute("style","width:"+kb+"px; height:"+lb+"px"),Ea.style.width=kb,Ea.style.height=lb,mb.range([jb.left,kb-jb.right]),Xa(Na,Ra,"x",Tb,mb),nb.range([lb-jb.bottom,jb.top]),Xa(Na,Ra,"y",Ub,nb),Ka.scale.x=mb,Ka.scale.original_x=mb.copy(),Ka.scale.y=nb,Ka.scale.original_y=nb.copy(),Aa(ob)&&(ob.range([lb-jb.bottom,jb.top]),Xa(Na,Ra,"y2",Vb,ob),Ka.scale.y2=ob,Ka.scale.original_y2=ob.copy())),Ha||(Ka.svg.clip_path=ga.append("clipPath").attr("id","clipPath").append("rect").attr("x",jb.left).attr("y",jb.top).attr("width",kb-jb.left-jb.right).attr("height",lb-jb.top-jb.bottom)),Ha)var kc=Ga(Ka,"XAXIS",d3.svg.axis().scale(mb),!1);else var kc=d3.svg.axis().scale(mb).outerTickSize(0);if(Aa(pb)&&kc.ticks(pb),Aa(sb)&&kc.tickFormat(sb),Ha)var lc=Ga(Ka,"YAXIS",d3.svg.axis().scale(nb).orient("left"),!1);else var lc=d3.svg.axis().scale(nb).orient("left").outerTickSize(0);if(Aa(qb)&&lc.ticks(qb),Aa(tb)&&lc.tickFormat(tb),Aa(ob)){if(Ha)var mc=Ga(Ka,"Y2AXIS",d3.svg.axis().scale(ob).orient("right"),!1);else var mc=d3.svg.axis().scale(ob).orient("right").outerTickSize(0);Aa(rb)&&mc.ticks(rb),Aa(ub)&&mc.tickFormat(ub)}var nc=Aa(Ka.svg.box.group);vb||Ka.svg.box.remove(),vb&&!nc&&(Ka.svg.box.group=ga.append("g").attr("class","d3lines-box"),Ka.svg.box.rect=Ka.svg.box.group.append("rect").attr("x",jb.left).attr("y",jb.top).attr("width",kb-jb.left-jb.right).attr("height",lb-jb.top-jb.bottom).style("stroke",dc).style("stroke-width",ec).style("stroke-dasharray",Ya(hc)).style("fill",fc).style("fill-opacity",gc)),Ha&&Aa(Ka.svg.lines.lines)||(Ka.svg.lines.lines=[]),Ha&&Aa(Ka.svg.lines.areas)||(Ka.svg.lines.areas=[]),Ha&&Aa(Ka.svg.lines.markers)||(Ka.svg.lines.markers=[]),Ha&&Aa(Ka.line_options)||(Ka.line_options=[]),Ha&&Aa(Ka.svg.lines.group)||(Ka.svg.lines.group=ga.append("g").attr("class","d3lines-lines"));var oc,pc=0;if(Ha&&(pc=Ka.line_options.length),Ra.forEach(function(a,b){function c(b,c){return(!a.hasOwnProperty("x")||!isNaN(a.x[c]))&&((!a.hasOwnProperty("offset_y")||!isNaN(a.offset_y[c]))&&(!a.hasOwnProperty("offset_y2")||!isNaN(a.offset_y2[c])))}Ka.line_options.push(a);var d=Ta(mb,nb,ob,a);d.defined(c);var e=a.color,f=a.width,g=a.style,h=a.fill,i=a.fill_opacity;if(oc=a.hasOwnProperty("label")?a.label:Aa(Sb)?$a(Sb,b+pc):a.hasOwnProperty("ykey")?a.ykey:a.hasOwnProperty("y2key")?a.y2key:"","color"===h&&(h=e),"none"!=h){var j=d3.svg.area().x(d.x()).y(d.y()).y0(nb.range()[0]).defined(c);Ka.svg.lines.areas.push(Ka.svg.lines.group.append("path").datum(Na).attr("d",j).style("fill",h).style("fill-opacity",i).attr("clip-path","url(#clipPath)"))}else Ka.svg.lines.areas.push(null);if(Ka.svg.lines.lines.push(Ka.svg.lines.group.append("svg:path").attr("d",d(Na)).attr("clip-path","url(#clipPath)").attr("data-legend",oc).attr("data-line-color",e).attr("data-line-width",f).attr("data-line-style",g).attr("data-line-fill",h).attr("data-marker",a.marker).attr("data-marker-fill",a.marker_fill).attr("data-marker-fill-opacity",a.marker_fill_opacity).attr("data-marker-stroke-width",a.marker_stroke_width).attr("data-marker-size",a.marker_size).attr("data-legend-pos",b+pc).style("fill","none").style("stroke",e).style("stroke-width",f).style("stroke-dasharray",Ya(g))),""!=a.marker){var k=a.marker_fill;"color"==k&&(k=e),Ka.svg.lines.markers.push(Ka.svg.lines.group.append("g").attr("clip-path","url(#clipPath)").attr("class","d3lines-markers")),Ka.svg.lines.markers[Ka.svg.lines.markers.length-1].selectAll(".markersymbols").data(Na).enter().append("path").attr("d",Za(a.marker,a.marker_size)).attr("transform",function(a,b){return"translate("+d.x()(a,b)+","+d.y()(a,b)+")"}).style("stroke",e).style("fill",k).style("fill-opacity",a.marker_fill_opacity).style("stroke-width",a.marker_stroke_width)}else Ka.svg.lines.markers.push(null)}),Aa(Xb)||1!==Ka.svg.lines.lines.length||(Xb=oc),Aa(Ka.svg.axes.group)||(Ka.svg.axes.group=ga.append("g").attr("class","d3lines-axes")),Ha||(Ka.xaxis=kc,Ka.svg.axes.x=Ka.svg.axes.group.append("svg:g").attr("class","d3lines-axis d3lines-xaxis").attr("transform","translate(0,"+(lb-jb.bottom)+")").call(kc),Ka.yaxis=lc,Ka.svg.axes.y=Ka.svg.axes.group.append("svg:g").attr("class","d3lines-axis d3lines-yaxis").attr("transform","translate("+jb.left+",0)").call(lc),Aa(ob)&&(Ka.y2axis=mc,Ka.svg.axes.y2=Ka.svg.axes.group.append("svg:g").attr("class","d3lines-axis d3lines-y2axis").attr("transform","translate("+(kb-jb.right)+",0)").call(mc)),cb(ga,Ba),db(ga,Ba,Aa(ob)),Ka.svg.axes.labels.group=Ka.svg.axes.group.append("g").attr("class","d3lines-label"),Aa(Wb)&&(Ka.svg.axes.labels.x=Ka.svg.axes.labels.group.append("text").attr("text-anchor","middle").attr("x",kb/2).attr("y",lb+Zb-5).text(Wb).style("font-size",ac),void 0!==bc&&Ka.svg.axes.labels.x.style("fill",bc),void 0!==cc&&Ka.svg.axes.labels.x.style("font-family",cc)),Aa(Xb)&&(Ka.svg.axes.labels.y=Ka.svg.axes.labels.group.append("text").attr("text-anchor","middle").attr("x",-lb/2).attr("y",-$b).attr("dy",".75em").attr("transform","rotate(-90)").text(Xb).style("font-size",ac),void 0!==bc&&Ka.svg.axes.labels.y.style("fill",bc),void 0!==cc&&Ka.svg.axes.labels.y.style("font-family",cc)),Aa(Yb)&&(Ka.svg.axes.labels.y2=Ka.svg.axes.labels.group.append("text").attr("text-anchor","middle").attr("x",lb/2).attr("y",-kb-_b).attr("dy",".75em").attr("transform","rotate(90)").text(Yb).style("font-size",ac),void 0!==bc&&Ka.svg.axes.labels.y2.style("fill",bc),void 0!==cc&&Ka.svg.axes.labels.y2.style("font-family",cc))),Ha&&(Ka.redraw(),Ra=Ka.line_options),Ka.svg.interactive.remove(),Ra.length>0&&ic){var qc=mb.domain()[0],sc=(mb.domain()[1],nb.domain()[0]);nb.domain()[1];if(Ka.svg.interactive.group=ga.append("g").attr("class","d3lines-interactive"),Ga(jc,"line",!1)){var uc=Ua(Ka.svg.interactive.group,qc,mb,nb);uc.attr("class","d3lines-interactive-vline").attr("clip-path","url(#clipPath)").style("stroke-dasharray",Ya(jc.line_style)).style("stroke",jc.line_color).style("stroke-width",jc.line_width).style("display","none"),Ka.svg.interactive.vline=uc;var vc=Va(Ka.svg.interactive.group,sc,mb,nb);vc.attr("class","d3lines-interactive-hline").attr("clip-path","url(#clipPath)").style("stroke-dasharray",Ya(jc.line_style)).style("stroke",jc.line_color).style("stroke-width",jc.line_width).style("display","none"),Ka.svg.interactive.hline=vc}if(Ga(jc,"dots",!1)){Ha&&Aa(Ka.svg.interactive.dots)||(Ka.svg.interactive.dots=[]);var wc=Ka.svg.interactive.group.append("g").attr("clip-path","url(#clipPath)");Ra.forEach(function(a,b){Ka.svg.interactive.dots.push(wc.append("circle").attr("r",jc.dot_radius).style("fill",a.color).style("display","none"))});var xc=Ka.svg.interactive.dots}if(Ga(jc,"textbox",!1)){var yc=Ka.svg.interactive.group.append("rect").attr("x",0).attr("y",0).attr("width",50).attr("height",50).style("fill",jc.box_fill).style("fill-opacity",jc.box_fill_opacity).style("display","none");Ka.svg.interactive.box=yc;var zc=Ka.svg.interactive.group.append("text").attr("x",0).attr("y",0).style("display","none").style("fill",jc.font_color).style("font-size",jc.font_size).style("font-family",jc.font_family);Ka.svg.interactive.text=zc}var Ac;Ea.addEventListener("mousemove",Bc),jc.zoom&&ga.call(d3.behavior.zoom().x(mb).y(nb).on("zoom",function(){if(Aa(ob)){var a=nb.domain(),b=Ka.scale.original_y(a[0]),c=Ka.scale.original_y(a[1]),d=[];d.push(Ka.scale.original_y2.invert(b)),d.push(Ka.scale.original_y2.invert(c)),ob.domain(d)}Ka.redraw(),Bc(Ac)}))}if(Ka.svg.legend.remove(),Ib&&Ra.length>0){Ka.svg.legend.group=ga.append("g").attr("class","d3lines-legend").attr("data-style-padding",10).style("font-size",Jb).call(Wa),Ka.svg.legend.group.select("rect").style("fill",Mb).style("fill-opacity",Nb).style("stroke",Ob).style("stroke-width",Pb).style("stroke-dasharray",Ya(Qb));var Cc=Ka.svg.legend.group.selectAll("rect")[0][0].getBBox(),Dc=0,Ec=0;if(Fa(Rb)&&2==Rb.length)Dc=Rb[0],Ec=Rb[1];else try{var Fc=JSON.parse(Rb);if(!Fa(Fc)){var Gc="Invalid legend position (valid values are 'top left', 'top right', ... or 2-element arrays with the position (ex: [100, 200]))";throw console.log(Gc),TypeError(Gc)}if(2!=Fc.length)throw Gc="Invalid legend position (valid values are 'top left', 'top right', ... or 2-element arrays with the position (ex: [100, 200]))",console.log(Gc),TypeError(Gc);Dc=Fc[0],Ec=Fc[1]}catch(a){Dc=-1==Rb.indexOf("right")?jb.left+10:kb-jb.right-Cc.width-10,Ec=-1==Rb.indexOf("bottom")?jb.top+10:lb-jb.bottom-Cc.height-10}Ka.svg.legend.group.attr("transform","translate("+Dc+","+Ec+")"),void 0!==Kb&&Ka.svg.legend.group.selectAll("text").style("fill",Kb),void 0!==Lb&&Ka.svg.legend.group.style("font-family",Lb)}return Ka},groupByPlot:function(a,b,c,d,e,f){function g(){return str="Usage:\n",str+="    plt = d3lines.groupByPlot(svg, data, groupByKey, renameKeys)\n\n",str+="Arguments:\n",str+="    svg (d3.selection): a d3 selection of the svg DOM element where you want your plot to be drawn\n",str+="    data (Array of objects or Array): the data to plot\n",str+="    xkey (string): the name of the key for the x-axis\n",str+="    groupByKey (string): the name of the key to group the data by\n\n",str+="Optional arguments:\n",str+="    renameKeys (function): a function to rename the data keys using the group name",str+="\n",str}if(!(a instanceof d3.selection))throw TypeError("`svg` must be a d3.selection object.");if(arguments.length<4)throw Error("Not enough arguments\n\n"+g());arguments.length<6&&(f=function(a,b){return a+" ("+b+")"});var h;if(Aa(e)&&"object"!=typeof e)throw TypeError("`options` should be an Object");var i=Ia(e)||{};i.hasOwnProperty("data")&&delete i.data,i.hasOwnProperty("xkey")&&delete i.xkey,b instanceof Ja&&(b=b.data);var j=d3.nest().key(function(a){return a[d]}).entries(b),k=Ga(i,"legend",O),l=Ga(i,"interactive",na),m=Ga(i,"legend_labels");return k&&!Aa(m)&&(legend_labels=[]),j.forEach(function(e,g){b=e.values,b=new d3lines.Data(b).ignoreColumns([d]).data,b.forEach(function(a,b){Object.keys(a).forEach(function(d){d!==c&&(a[f(d,e.key)]=a[d],0==b&&k&&!Aa(m)&&legend_labels.push(f(d,e.key)),delete a[d])})}),add_options={data:b,legend:!1,interactive:!1,xkey:c},Aa(m)&&(add_options.legend_labels=m),Object.keys(i).forEach(function(a){add_options[a]=i[a]}),0==g?h=d3lines.plot(a,add_options):(g===j.length-1&&(k?(Aa(m)?add_options.legend_labels=m:add_options.legend_labels=legend_labels,add_options.legend=!0):add_options.legend=!1,add_options.interactive=l),h=d3lines.plot(a,add_options,h))}),h}}}();